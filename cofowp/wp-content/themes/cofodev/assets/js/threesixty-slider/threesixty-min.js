!function($){"use strict";$.ThreeSixty=function(e,r){var t=this,a,n=[],o="2.0.5";t.$el=$(e),t.el=e,t.$el.data("ThreeSixty",t),t.init=function(){a=$.extend({},$.ThreeSixty.defaultOptions,r),a.disableSpin&&(a.currentFrame=1,a.endFrame=1),t.initProgress(),t.loadImages()},t.resize=function(){},t.initProgress=function(){t.$el.css({width:a.width+"px",height:a.height+"px","background-image":"none !important"}),a.styles&&t.$el.css(a.styles),t.responsive(),t.$el.find(a.progress).css({marginTop:a.height/2-15+"px"}),t.$el.find(a.progress).fadeIn("slow"),t.$el.find(a.imgList).hide()},t.loadImages=function(){var e,r,o,i,s;e=document.createElement("li"),s=a.zeroBased?0:1,r=a.imgArray?a.imgArray[a.loadedImages]:a.domain+a.imagePath+a.filePrefix+t.zeroPad(a.loadedImages+s)+a.ext+(t.browser.isIE()?"?"+(new Date).getTime():""),o=$("<img>").attr("src",r).addClass("previous-image").appendTo(e),n.push(o),t.$el.find(a.imgList).append(e),$(o).on("load",function(){t.imageLoaded()})},t.imageLoaded=function(){a.loadedImages+=1,$(a.progress+" span").text(Math.floor(a.loadedImages/a.totalFrames*100)+"%"),a.loadedImages>=a.totalFrames?(a.disableSpin&&n[0].removeClass("previous-image").addClass("current-image"),$(a.progress).fadeOut("slow",function(){$(this).hide(),t.showImages(),t.showNavigation()})):t.loadImages()},t.showImages=function(){t.$el.find(".txtC").fadeIn(),t.$el.find(a.imgList).fadeIn(),$(".threesixty .instructions").fadeIn(),t.ready=!0,a.ready=!0,a.drag&&t.initEvents(),t.refresh(),t.initPlugins(),a.onReady(),setTimeout(function(){t.responsive()},50)},t.initPlugins=function(){$.each(a.plugins,function(e,r){if("function"!=typeof $[r])throw new Error(r+" not available.");$[r].call(t,t.$el,a)})},t.showNavigation=function(){if(a.navigation&&!a.navigation_init){var e,r,n,o;e=$("<div/>").attr("class","nav_bar"),r=$("<a/>").attr({href:"#",class:"nav_bar_next"}).html("next"),n=$("<a/>").attr({href:"#",class:"nav_bar_previous"}).html("previous"),o=$("<a/>").attr({href:"#",class:"nav_bar_play"}).html("play"),e.append(n),e.append(o),e.append(r),t.$el.prepend(e),r.bind("mousedown touchstart",t.next),n.bind("mousedown touchstart",t.previous),o.bind("mousedown touchstart",t.play_stop),a.navigation_init=!0}},t.play_stop=function(e){e.preventDefault(),a.autoplay?(a.autoplay=!1,$(e.currentTarget).removeClass("nav_bar_stop").addClass("nav_bar_play"),clearInterval(a.play),a.play=null):(a.autoplay=!0,a.play=setInterval(t.moveToNextFrame,a.playSpeed),$(e.currentTarget).removeClass("nav_bar_play").addClass("nav_bar_stop"))},t.next=function(e){e&&e.preventDefault(),a.endFrame-=5,t.refresh()},t.previous=function(e){e&&e.preventDefault(),a.endFrame+=5,t.refresh()},t.play=function(e,r){var n=e||a.playSpeed,o=r||a.autoplayDirection;a.autoplayDirection=o,a.autoplay||(a.autoplay=!0,a.play=setInterval(t.moveToNextFrame,n))},t.stop=function(){a.autoplay&&(a.autoplay=!1,clearInterval(a.play),a.play=null)},t.moveToNextFrame=function(){1===a.autoplayDirection?a.endFrame-=1:a.endFrame+=1,t.refresh()},t.gotoAndPlay=function(e){if(a.disableWrap)a.endFrame=e,t.refresh();else{var r=Math.ceil(a.endFrame/a.totalFrames);0===r&&(r=1);var n=r>1?a.endFrame-(r-1)*a.totalFrames:a.endFrame,o=a.totalFrames-n,i=0;i=e-n>0?e-n<n+(a.totalFrames-e)?a.endFrame+(e-n):a.endFrame-(n+(a.totalFrames-e)):n-e<o+e?a.endFrame-(n-e):a.endFrame+(o+e),n!==e&&(a.endFrame=i,t.refresh())}},t.initEvents=function(){t.$el.bind("mousedown touchstart touchmove touchend mousemove click",function(e){e.preventDefault(),"mousedown"===e.type&&1===e.which||"touchstart"===e.type?(console.log("mousedown"),a.pointerStartPosX=t.getPointerEvent(e).pageX,a.dragging=!0,a.onDragStart(a.currentFrame)):"touchmove"===e.type?t.trackPointer(e):"touchend"===e.type&&(a.dragging=!1,t.$el.removeClass("dragging"),a.onDragStop(a.endFrame))}),$(document).bind("mouseup",function(e){console.log("mouseup"),a.dragging&&(e.preventDefault(),a.dragging=!1,t.$el.removeClass("dragging"),a.onDragStop(a.endFrame),$(this).css("cursor","none"))}),$(window).bind("resize",function(){t.responsive()}),$(document).bind("mousemove",function(e){console.log("mousemove"),a.dragging?(t.$el.addClass("dragging"),e.preventDefault(),!t.browser.isIE&&a.showCursor&&t.$el.css("cursor","url(assets/images/hand_closed.png), auto")):!t.browser.isIE&&a.showCursor&&t.$el.css("cursor","url(assets/images/hand_open.png), auto"),t.trackPointer(e)}),$(window).resize(function(){t.resize()})},t.getPointerEvent=function(e){return e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e},t.trackPointer=function(e){a.ready&&a.dragging&&(a.pointerEndPosX=t.getPointerEvent(e).pageX,a.monitorStartTime<(new Date).getTime()-a.monitorInt&&(a.pointerDistance=a.pointerEndPosX-a.pointerStartPosX,a.pointerDistance>0?a.endFrame=a.currentFrame+Math.ceil((a.totalFrames-1)*a.speedMultiplier*(a.pointerDistance/t.$el.width())):a.endFrame=a.currentFrame+Math.floor((a.totalFrames-1)*a.speedMultiplier*(a.pointerDistance/t.$el.width())),a.disableWrap&&(a.endFrame=Math.min(a.totalFrames-(a.zeroBased?1:0),a.endFrame),a.endFrame=Math.max(a.zeroBased?0:1,a.endFrame)),t.refresh(),a.monitorStartTime=(new Date).getTime(),a.pointerStartPosX=t.getPointerEvent(e).pageX))},t.refresh=function(){0===a.ticker&&(a.ticker=setInterval(t.render,Math.round(1e3/a.framerate)))},t.render=function(){var e;a.currentFrame!==a.endFrame?(e=a.endFrame<a.currentFrame?Math.floor(.1*(a.endFrame-a.currentFrame)):Math.ceil(.1*(a.endFrame-a.currentFrame)),t.hidePreviousFrame(),a.currentFrame+=e,t.showCurrentFrame(),t.$el.trigger("frameIndexChanged",[t.getNormalizedCurrentFrame(),a.totalFrames])):(window.clearInterval(a.ticker),a.ticker=0)},t.hidePreviousFrame=function(){n[t.getNormalizedCurrentFrame()].removeClass("current-image").addClass("previous-image")},t.showCurrentFrame=function(){n[t.getNormalizedCurrentFrame()].removeClass("previous-image").addClass("current-image")},t.getNormalizedCurrentFrame=function(){var e,r;return a.disableWrap?(e=Math.min(a.currentFrame,a.totalFrames-(a.zeroBased?1:0)),r=Math.min(a.endFrame,a.totalFrames-(a.zeroBased?1:0)),e=Math.max(e,a.zeroBased?0:1),r=Math.max(r,a.zeroBased?0:1),a.currentFrame=e,a.endFrame=r):(e=Math.ceil(a.currentFrame%a.totalFrames),e<0&&(e+=a.totalFrames-(a.zeroBased?1:0))),e},t.getCurrentFrame=function(){return a.currentFrame},t.responsive=function(){a.responsive&&t.$el.css({height:t.$el.find(".current-image").first().css("height"),width:"100%"})},t.zeroPad=function(e){function r(e,r){var t=e.toString();if(a.zeroPadding)for(;t.length<r;)t="0"+t;return t}var t=Math.log(a.totalFrames)/Math.LN10,n=1e3,o=Math.round(t*n)/n,i=Math.floor(o)+1;return r(e,i)},t.browser={},t.browser.isIE=function(){var e=-1;if("Microsoft Internet Explorer"===navigator.appName){var r=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");null!==t.exec(r)&&(e=parseFloat(RegExp.$1))}return e!==-1},t.getConfig=function(){return a},$.ThreeSixty.defaultOptions={dragging:!1,ready:!1,pointerStartPosX:0,pointerEndPosX:0,pointerDistance:0,monitorStartTime:0,monitorInt:10,ticker:0,speedMultiplier:7,totalFrames:180,currentFrame:0,endFrame:0,loadedImages:0,framerate:60,domains:null,domain:"",parallel:!1,queueAmount:8,idle:0,filePrefix:"",ext:"png",height:300,width:300,styles:{},navigation:!1,autoplay:!1,autoplayDirection:1,disableSpin:!1,disableWrap:!1,responsive:!1,zeroPadding:!1,zeroBased:!1,plugins:[],showCursor:!1,drag:!0,onReady:function(){},onDragStart:function(){},onDragStop:function(){},imgList:".threesixty_images",imgArray:null,playSpeed:100},t.init()},$.fn.ThreeSixty=function(e){return Object.create(new $.ThreeSixty(this,e))}}(jQuery),"function"!=typeof Object.create&&(Object.create=function(e){"use strict";function r(){}return r.prototype=e,new r});